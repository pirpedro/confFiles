#!/bin/bash
#shellcheck source=ext/functions.sh
source $MY_CONFIG_EXT/functions.sh

case "$1" in
install)
  brew_install zsh
  git clone --recursive https://github.com/sorin-ionescu/prezto.git "${ZDOTDIR:-$HOME}/.zprezto"
  zsh -c 'setopt EXTENDED_GLOB
for rcfile in "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/^README.md(.N); do
  cp "$rcfile" "${ZDOTDIR:-$HOME}/.${rcfile:t}"
done'
  brew_install zsh-completions
  if ! grep -xq "$(my_resource 'profile' | head -n1)" ~/.zshrc; then
      my_resource "profile" >> ~/.zshrc
  fi
  if ! grep -xq "$(my_resource 'my-project-wrap-function' | head -n1)" ~/.zshrc; then
      my_resource "my-project-wrap-function" >> ~/.zshrc
  fi

  if ask_boolean "Change default shell to zsh?"; then
    chsh -s /bin/zsh
  fi
  zsh -c 'rm -f ~/.zcompdump; compinit'
;;
remove)
;;
update)
  git pull ${ZDOTDIR:-$HOME}/.zprezto && git submodule update --recursive --remote ${ZDOTDIR:-$HOME}/.zprezto
;;
esac
